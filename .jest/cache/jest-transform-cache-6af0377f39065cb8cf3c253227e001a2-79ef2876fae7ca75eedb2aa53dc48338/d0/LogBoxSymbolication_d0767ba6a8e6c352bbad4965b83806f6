4304287bb9da2755d38d6640160d27d2
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.deleteStack = deleteStack;
exports.symbolicate = symbolicate;
var _symbolicateStackTrace = _interopRequireDefault(require("../../Core/Devtools/symbolicateStackTrace"));
var cache = new Map();
var sanitize = function sanitize(_ref) {
  var maybeStack = _ref.stack,
    codeFrame = _ref.codeFrame;
  if (!Array.isArray(maybeStack)) {
    throw new Error('Expected stack to be an array.');
  }
  var stack = [];
  for (var maybeFrame of maybeStack) {
    var collapse = false;
    if ('collapse' in maybeFrame) {
      if (typeof maybeFrame.collapse !== 'boolean') {
        throw new Error('Expected stack frame `collapse` to be a boolean.');
      }
      collapse = maybeFrame.collapse;
    }
    stack.push({
      column: maybeFrame.column,
      file: maybeFrame.file,
      lineNumber: maybeFrame.lineNumber,
      methodName: maybeFrame.methodName,
      collapse: collapse
    });
  }
  return {
    stack: stack,
    codeFrame: codeFrame
  };
};
function deleteStack(stack) {
  cache.delete(stack);
}
function symbolicate(stack, extraData) {
  var promise = cache.get(stack);
  if (promise == null) {
    promise = (0, _symbolicateStackTrace.default)(stack, extraData).then(sanitize);
    cache.set(stack, promise);
  }
  return promise;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfc3ltYm9saWNhdGVTdGFja1RyYWNlIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJjYWNoZSIsIk1hcCIsInNhbml0aXplIiwiX3JlZiIsIm1heWJlU3RhY2siLCJzdGFjayIsImNvZGVGcmFtZSIsIkFycmF5IiwiaXNBcnJheSIsIkVycm9yIiwibWF5YmVGcmFtZSIsImNvbGxhcHNlIiwicHVzaCIsImNvbHVtbiIsImZpbGUiLCJsaW5lTnVtYmVyIiwibWV0aG9kTmFtZSIsImRlbGV0ZVN0YWNrIiwiZGVsZXRlIiwic3ltYm9saWNhdGUiLCJleHRyYURhdGEiLCJwcm9taXNlIiwiZ2V0Iiwic3ltYm9saWNhdGVTdGFja1RyYWNlIiwidGhlbiIsInNldCJdLCJzb3VyY2VzIjpbIkxvZ0JveFN5bWJvbGljYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIE1ldGEgUGxhdGZvcm1zLCBJbmMuIGFuZCBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmbG93IHN0cmljdFxuICogQGZvcm1hdFxuICovXG5cbmltcG9ydCB0eXBlIHtTeW1ib2xpY2F0ZWRTdGFja1RyYWNlfSBmcm9tICcuLi8uLi9Db3JlL0RldnRvb2xzL3N5bWJvbGljYXRlU3RhY2tUcmFjZSc7XG5pbXBvcnQgdHlwZSB7U3RhY2tGcmFtZX0gZnJvbSAnLi4vLi4vQ29yZS9OYXRpdmVFeGNlcHRpb25zTWFuYWdlcic7XG5cbmltcG9ydCBzeW1ib2xpY2F0ZVN0YWNrVHJhY2UgZnJvbSAnLi4vLi4vQ29yZS9EZXZ0b29scy9zeW1ib2xpY2F0ZVN0YWNrVHJhY2UnO1xuXG5leHBvcnQgdHlwZSBTdGFjayA9IEFycmF5PFN0YWNrRnJhbWU+O1xuXG5jb25zdCBjYWNoZTogTWFwPFN0YWNrLCBQcm9taXNlPFN5bWJvbGljYXRlZFN0YWNrVHJhY2U+PiA9IG5ldyBNYXAoKTtcblxuLyoqXG4gKiBTYW5pdGl6ZSBiZWNhdXNlIHNvbWV0aW1lcywgYHN5bWJvbGljYXRlU3RhY2tUcmFjZWAgZ2l2ZXMgdXMgaW52YWxpZCB2YWx1ZXMuXG4gKi9cbmNvbnN0IHNhbml0aXplID0gKHtcbiAgc3RhY2s6IG1heWJlU3RhY2ssXG4gIGNvZGVGcmFtZSxcbn06IFN5bWJvbGljYXRlZFN0YWNrVHJhY2UpOiBTeW1ib2xpY2F0ZWRTdGFja1RyYWNlID0+IHtcbiAgaWYgKCFBcnJheS5pc0FycmF5KG1heWJlU3RhY2spKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdFeHBlY3RlZCBzdGFjayB0byBiZSBhbiBhcnJheS4nKTtcbiAgfVxuICBjb25zdCBzdGFjazogQXJyYXk8U3RhY2tGcmFtZT4gPSBbXTtcbiAgZm9yIChjb25zdCBtYXliZUZyYW1lIG9mIG1heWJlU3RhY2spIHtcbiAgICBsZXQgY29sbGFwc2UgPSBmYWxzZTtcbiAgICBpZiAoJ2NvbGxhcHNlJyBpbiBtYXliZUZyYW1lKSB7XG4gICAgICBpZiAodHlwZW9mIG1heWJlRnJhbWUuY29sbGFwc2UgIT09ICdib29sZWFuJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIHN0YWNrIGZyYW1lIGBjb2xsYXBzZWAgdG8gYmUgYSBib29sZWFuLicpO1xuICAgICAgfVxuICAgICAgY29sbGFwc2UgPSBtYXliZUZyYW1lLmNvbGxhcHNlO1xuICAgIH1cbiAgICBzdGFjay5wdXNoKHtcbiAgICAgIGNvbHVtbjogbWF5YmVGcmFtZS5jb2x1bW4sXG4gICAgICBmaWxlOiBtYXliZUZyYW1lLmZpbGUsXG4gICAgICBsaW5lTnVtYmVyOiBtYXliZUZyYW1lLmxpbmVOdW1iZXIsXG4gICAgICBtZXRob2ROYW1lOiBtYXliZUZyYW1lLm1ldGhvZE5hbWUsXG4gICAgICBjb2xsYXBzZSxcbiAgICB9KTtcbiAgfVxuICByZXR1cm4ge3N0YWNrLCBjb2RlRnJhbWV9O1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZVN0YWNrKHN0YWNrOiBTdGFjayk6IHZvaWQge1xuICBjYWNoZS5kZWxldGUoc3RhY2spO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3ltYm9saWNhdGUoXG4gIHN0YWNrOiBTdGFjayxcbiAgZXh0cmFEYXRhPzogbWl4ZWQsXG4pOiBQcm9taXNlPFN5bWJvbGljYXRlZFN0YWNrVHJhY2U+IHtcbiAgbGV0IHByb21pc2UgPSBjYWNoZS5nZXQoc3RhY2spO1xuICBpZiAocHJvbWlzZSA9PSBudWxsKSB7XG4gICAgcHJvbWlzZSA9IHN5bWJvbGljYXRlU3RhY2tUcmFjZShzdGFjaywgZXh0cmFEYXRhKS50aGVuKHNhbml0aXplKTtcbiAgICBjYWNoZS5zZXQoc3RhY2ssIHByb21pc2UpO1xuICB9XG5cbiAgcmV0dXJuIHByb21pc2U7XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQWFBLElBQUFBLHNCQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFJQSxJQUFNQyxLQUFrRCxHQUFHLElBQUlDLEdBQUcsQ0FBQyxDQUFDO0FBS3BFLElBQU1DLFFBQVEsR0FBRyxTQUFYQSxRQUFRQSxDQUFBQyxJQUFBLEVBR3dDO0VBQUEsSUFGN0NDLFVBQVUsR0FBQUQsSUFBQSxDQUFqQkUsS0FBSztJQUNMQyxTQUFTLEdBQUFILElBQUEsQ0FBVEcsU0FBUztFQUVULElBQUksQ0FBQ0MsS0FBSyxDQUFDQyxPQUFPLENBQUNKLFVBQVUsQ0FBQyxFQUFFO0lBQzlCLE1BQU0sSUFBSUssS0FBSyxDQUFDLGdDQUFnQyxDQUFDO0VBQ25EO0VBQ0EsSUFBTUosS0FBd0IsR0FBRyxFQUFFO0VBQ25DLEtBQUssSUFBTUssVUFBVSxJQUFJTixVQUFVLEVBQUU7SUFDbkMsSUFBSU8sUUFBUSxHQUFHLEtBQUs7SUFDcEIsSUFBSSxVQUFVLElBQUlELFVBQVUsRUFBRTtNQUM1QixJQUFJLE9BQU9BLFVBQVUsQ0FBQ0MsUUFBUSxLQUFLLFNBQVMsRUFBRTtRQUM1QyxNQUFNLElBQUlGLEtBQUssQ0FBQyxrREFBa0QsQ0FBQztNQUNyRTtNQUNBRSxRQUFRLEdBQUdELFVBQVUsQ0FBQ0MsUUFBUTtJQUNoQztJQUNBTixLQUFLLENBQUNPLElBQUksQ0FBQztNQUNUQyxNQUFNLEVBQUVILFVBQVUsQ0FBQ0csTUFBTTtNQUN6QkMsSUFBSSxFQUFFSixVQUFVLENBQUNJLElBQUk7TUFDckJDLFVBQVUsRUFBRUwsVUFBVSxDQUFDSyxVQUFVO01BQ2pDQyxVQUFVLEVBQUVOLFVBQVUsQ0FBQ00sVUFBVTtNQUNqQ0wsUUFBUSxFQUFSQTtJQUNGLENBQUMsQ0FBQztFQUNKO0VBQ0EsT0FBTztJQUFDTixLQUFLLEVBQUxBLEtBQUs7SUFBRUMsU0FBUyxFQUFUQTtFQUFTLENBQUM7QUFDM0IsQ0FBQztBQUVNLFNBQVNXLFdBQVdBLENBQUNaLEtBQVksRUFBUTtFQUM5Q0wsS0FBSyxDQUFDa0IsTUFBTSxDQUFDYixLQUFLLENBQUM7QUFDckI7QUFFTyxTQUFTYyxXQUFXQSxDQUN6QmQsS0FBWSxFQUNaZSxTQUFpQixFQUNnQjtFQUNqQyxJQUFJQyxPQUFPLEdBQUdyQixLQUFLLENBQUNzQixHQUFHLENBQUNqQixLQUFLLENBQUM7RUFDOUIsSUFBSWdCLE9BQU8sSUFBSSxJQUFJLEVBQUU7SUFDbkJBLE9BQU8sR0FBRyxJQUFBRSw4QkFBcUIsRUFBQ2xCLEtBQUssRUFBRWUsU0FBUyxDQUFDLENBQUNJLElBQUksQ0FBQ3RCLFFBQVEsQ0FBQztJQUNoRUYsS0FBSyxDQUFDeUIsR0FBRyxDQUFDcEIsS0FBSyxFQUFFZ0IsT0FBTyxDQUFDO0VBQzNCO0VBRUEsT0FBT0EsT0FBTztBQUNoQiIsImlnbm9yZUxpc3QiOltdfQ==