{"version":3,"names":["_react","_interopRequireWildcard","require","React","_act","_interopRequireDefault","_cleanup","_config","_componentTree","_debugDeep","_debugShallow","_hostComponentNames","_stringValidation","_renderAct","_screen","_within","obj","__esModule","default","_getRequireWildcardCache","e","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","render","component","options","arguments","length","undefined","renderInternal","_ref","Wrapper","wrapper","createNodeMock","unstable_validateStringsRenderedWithinText","_ref$detectHostCompon","detectHostComponentNames","configureHostComponentNamesIfNeeded","renderWithStringValidation","wrap","element","createElement","renderer","renderWithAct","buildRenderResult","_ref2","handleRender","_","phase","validateStringsRenderedWithinText","screen","toJSON","Profiler","id","onRender","update","updateWithAct","instance","root","unmount","addToCleanupQueue","result","assign","getQueriesForElement","rerender","debug","getHostChildren","UNSAFE_root","enumerable","Error","setRenderResult","debugImpl","_ref3","getConfig","defaultDebugOptions","debugOptions","message","console","warn","json","shallow"],"sources":["../src/render.tsx"],"sourcesContent":["import type { ReactTestInstance, ReactTestRenderer } from 'react-test-renderer';\nimport * as React from 'react';\nimport { Profiler } from 'react';\nimport act from './act';\nimport { addToCleanupQueue } from './cleanup';\nimport { getConfig } from './config';\nimport { getHostChildren } from './helpers/component-tree';\nimport debugDeep, { DebugOptions } from './helpers/debug-deep';\nimport debugShallow from './helpers/debug-shallow';\nimport { configureHostComponentNamesIfNeeded } from './helpers/host-component-names';\nimport { validateStringsRenderedWithinText } from './helpers/string-validation';\nimport { renderWithAct } from './render-act';\nimport { setRenderResult, screen } from './screen';\nimport { getQueriesForElement } from './within';\n\nexport interface RenderOptions {\n  wrapper?: React.ComponentType<any>;\n  createNodeMock?: (element: React.ReactElement) => any;\n  unstable_validateStringsRenderedWithinText?: boolean;\n}\n\nexport type RenderResult = ReturnType<typeof render>;\n\n/**\n * Renders test component deeply using React Test Renderer and exposes helpers\n * to assert on the output.\n */\nexport default function render<T>(component: React.ReactElement<T>, options: RenderOptions = {}) {\n  return renderInternal(component, options);\n}\n\nexport interface RenderInternalOptions extends RenderOptions {\n  detectHostComponentNames?: boolean;\n}\n\nexport function renderInternal<T>(\n  component: React.ReactElement<T>,\n  {\n    wrapper: Wrapper,\n    createNodeMock,\n    unstable_validateStringsRenderedWithinText,\n    detectHostComponentNames = true,\n  }: RenderInternalOptions = {},\n) {\n  if (detectHostComponentNames) {\n    configureHostComponentNamesIfNeeded();\n  }\n\n  if (unstable_validateStringsRenderedWithinText) {\n    return renderWithStringValidation(component, {\n      wrapper: Wrapper,\n      createNodeMock,\n    });\n  }\n\n  const wrap = (element: React.ReactElement) => (Wrapper ? <Wrapper>{element}</Wrapper> : element);\n\n  const renderer = renderWithAct(wrap(component), createNodeMock ? { createNodeMock } : undefined);\n\n  return buildRenderResult(renderer, wrap);\n}\n\nfunction renderWithStringValidation<T>(\n  component: React.ReactElement<T>,\n  {\n    wrapper: Wrapper,\n    createNodeMock,\n  }: Omit<RenderOptions, 'unstable_validateStringsRenderedWithinText'> = {},\n) {\n  const handleRender: React.ProfilerProps['onRender'] = (_, phase) => {\n    if (phase === 'update') {\n      validateStringsRenderedWithinText(screen.toJSON());\n    }\n  };\n\n  const wrap = (element: React.ReactElement) => (\n    <Profiler id=\"renderProfiler\" onRender={handleRender}>\n      {Wrapper ? <Wrapper>{element}</Wrapper> : element}\n    </Profiler>\n  );\n\n  const renderer = renderWithAct(wrap(component), createNodeMock ? { createNodeMock } : undefined);\n  validateStringsRenderedWithinText(renderer.toJSON());\n\n  return buildRenderResult(renderer, wrap);\n}\n\nfunction buildRenderResult(\n  renderer: ReactTestRenderer,\n  wrap: (element: React.ReactElement) => JSX.Element,\n) {\n  const update = updateWithAct(renderer, wrap);\n  const instance = renderer.root;\n\n  const unmount = () => {\n    void act(() => {\n      renderer.unmount();\n    });\n  };\n\n  addToCleanupQueue(unmount);\n\n  const result = {\n    ...getQueriesForElement(instance),\n    update,\n    unmount,\n    rerender: update, // alias for `update`\n    toJSON: renderer.toJSON,\n    debug: debug(instance, renderer),\n    get root(): ReactTestInstance {\n      return getHostChildren(instance)[0];\n    },\n    UNSAFE_root: instance,\n  };\n\n  // Add as non-enumerable property, so that it's safe to enumerate\n  // `render` result, e.g. using destructuring rest syntax.\n  Object.defineProperty(result, 'container', {\n    enumerable: false,\n    get() {\n      throw new Error(\n        \"'container' property has been renamed to 'UNSAFE_root'.\\n\\n\" +\n          \"Consider using 'root' property which returns root host element.\",\n      );\n    },\n  });\n\n  setRenderResult(result);\n  return result;\n}\n\nfunction updateWithAct(\n  renderer: ReactTestRenderer,\n  wrap: (innerElement: React.ReactElement) => React.ReactElement,\n) {\n  return function (component: React.ReactElement) {\n    void act(() => {\n      renderer.update(wrap(component));\n    });\n  };\n}\n\nexport interface DebugFunction {\n  (options?: DebugOptions | string): void;\n  shallow: (message?: string) => void;\n}\n\nfunction debug(instance: ReactTestInstance, renderer: ReactTestRenderer): DebugFunction {\n  function debugImpl(options?: DebugOptions | string) {\n    const { defaultDebugOptions } = getConfig();\n    const debugOptions =\n      typeof options === 'string'\n        ? { ...defaultDebugOptions, message: options }\n        : { ...defaultDebugOptions, ...options };\n\n    if (typeof options === 'string') {\n      // eslint-disable-next-line no-console\n      console.warn(\n        'Using debug(\"message\") is deprecated and will be removed in future release, please use debug({ message; \"message\" }) instead.',\n      );\n    }\n\n    const json = renderer.toJSON();\n    if (json) {\n      return debugDeep(json, debugOptions);\n    }\n  }\n  debugImpl.shallow = (message?: string) => debugShallow(instance, message);\n  return debugImpl;\n}\n"],"mappings":"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","ignoreList":[]}