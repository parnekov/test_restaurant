eb46fa54e90e6bb1e3999162cf1bec91
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = render;
exports.renderInternal = renderInternal;
var _react = _interopRequireWildcard(require("react"));
var React = _react;
var _act = _interopRequireDefault(require("./act"));
var _cleanup = require("./cleanup");
var _config = require("./config");
var _componentTree = require("./helpers/component-tree");
var _debugDeep = _interopRequireDefault(require("./helpers/debug-deep"));
var _debugShallow = _interopRequireDefault(require("./helpers/debug-shallow"));
var _hostComponentNames = require("./helpers/host-component-names");
var _stringValidation = require("./helpers/string-validation");
var _renderAct = require("./render-act");
var _screen = require("./screen");
var _within = require("./within");
function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}
function _getRequireWildcardCache(e) {
  if ("function" != typeof WeakMap) return null;
  var r = new WeakMap(),
    t = new WeakMap();
  return (_getRequireWildcardCache = function _getRequireWildcardCache(e) {
    return e ? t : r;
  })(e);
}
function _interopRequireWildcard(e, r) {
  if (!r && e && e.__esModule) return e;
  if (null === e || "object" != typeof e && "function" != typeof e) return {
    default: e
  };
  var t = _getRequireWildcardCache(r);
  if (t && t.has(e)) return t.get(e);
  var n = {
      __proto__: null
    },
    a = Object.defineProperty && Object.getOwnPropertyDescriptor;
  for (var u in e) if ("default" !== u && Object.prototype.hasOwnProperty.call(e, u)) {
    var i = a ? Object.getOwnPropertyDescriptor(e, u) : null;
    i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u];
  }
  return n.default = e, t && t.set(e, n), n;
}
function render(component) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  return renderInternal(component, options);
}
function renderInternal(component) {
  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
    Wrapper = _ref.wrapper,
    createNodeMock = _ref.createNodeMock,
    unstable_validateStringsRenderedWithinText = _ref.unstable_validateStringsRenderedWithinText,
    _ref$detectHostCompon = _ref.detectHostComponentNames,
    detectHostComponentNames = _ref$detectHostCompon === void 0 ? true : _ref$detectHostCompon;
  if (detectHostComponentNames) {
    (0, _hostComponentNames.configureHostComponentNamesIfNeeded)();
  }
  if (unstable_validateStringsRenderedWithinText) {
    return renderWithStringValidation(component, {
      wrapper: Wrapper,
      createNodeMock: createNodeMock
    });
  }
  var wrap = function wrap(element) {
    return Wrapper ? React.createElement(Wrapper, null, element) : element;
  };
  var renderer = (0, _renderAct.renderWithAct)(wrap(component), createNodeMock ? {
    createNodeMock: createNodeMock
  } : undefined);
  return buildRenderResult(renderer, wrap);
}
function renderWithStringValidation(component) {
  var _ref2 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
    Wrapper = _ref2.wrapper,
    createNodeMock = _ref2.createNodeMock;
  var handleRender = function handleRender(_, phase) {
    if (phase === 'update') {
      (0, _stringValidation.validateStringsRenderedWithinText)(_screen.screen.toJSON());
    }
  };
  var wrap = function wrap(element) {
    return React.createElement(_react.Profiler, {
      id: "renderProfiler",
      onRender: handleRender
    }, Wrapper ? React.createElement(Wrapper, null, element) : element);
  };
  var renderer = (0, _renderAct.renderWithAct)(wrap(component), createNodeMock ? {
    createNodeMock: createNodeMock
  } : undefined);
  (0, _stringValidation.validateStringsRenderedWithinText)(renderer.toJSON());
  return buildRenderResult(renderer, wrap);
}
function buildRenderResult(renderer, wrap) {
  var update = updateWithAct(renderer, wrap);
  var instance = renderer.root;
  var unmount = function unmount() {
    void (0, _act.default)(function () {
      renderer.unmount();
    });
  };
  (0, _cleanup.addToCleanupQueue)(unmount);
  var result = Object.assign({}, (0, _within.getQueriesForElement)(instance), {
    update: update,
    unmount: unmount,
    rerender: update,
    toJSON: renderer.toJSON,
    debug: debug(instance, renderer),
    get root() {
      return (0, _componentTree.getHostChildren)(instance)[0];
    },
    UNSAFE_root: instance
  });
  Object.defineProperty(result, 'container', {
    enumerable: false,
    get: function get() {
      throw new Error("'container' property has been renamed to 'UNSAFE_root'.\n\n" + "Consider using 'root' property which returns root host element.");
    }
  });
  (0, _screen.setRenderResult)(result);
  return result;
}
function updateWithAct(renderer, wrap) {
  return function (component) {
    void (0, _act.default)(function () {
      renderer.update(wrap(component));
    });
  };
}
function debug(instance, renderer) {
  function debugImpl(options) {
    var _ref3 = (0, _config.getConfig)(),
      defaultDebugOptions = _ref3.defaultDebugOptions;
    var debugOptions = typeof options === 'string' ? Object.assign({}, defaultDebugOptions, {
      message: options
    }) : Object.assign({}, defaultDebugOptions, options);
    if (typeof options === 'string') {
      console.warn('Using debug("message") is deprecated and will be removed in future release, please use debug({ message; "message" }) instead.');
    }
    var json = renderer.toJSON();
    if (json) {
      return (0, _debugDeep.default)(json, debugOptions);
    }
  }
  debugImpl.shallow = function (message) {
    return (0, _debugShallow.default)(instance, message);
  };
  return debugImpl;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInJlcXVpcmUiLCJSZWFjdCIsIl9hY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX2NsZWFudXAiLCJfY29uZmlnIiwiX2NvbXBvbmVudFRyZWUiLCJfZGVidWdEZWVwIiwiX2RlYnVnU2hhbGxvdyIsIl9ob3N0Q29tcG9uZW50TmFtZXMiLCJfc3RyaW5nVmFsaWRhdGlvbiIsIl9yZW5kZXJBY3QiLCJfc2NyZWVuIiwiX3dpdGhpbiIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlIiwiZSIsIldlYWtNYXAiLCJyIiwidCIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsInJlbmRlciIsImNvbXBvbmVudCIsIm9wdGlvbnMiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJyZW5kZXJJbnRlcm5hbCIsIl9yZWYiLCJXcmFwcGVyIiwid3JhcHBlciIsImNyZWF0ZU5vZGVNb2NrIiwidW5zdGFibGVfdmFsaWRhdGVTdHJpbmdzUmVuZGVyZWRXaXRoaW5UZXh0IiwiX3JlZiRkZXRlY3RIb3N0Q29tcG9uIiwiZGV0ZWN0SG9zdENvbXBvbmVudE5hbWVzIiwiY29uZmlndXJlSG9zdENvbXBvbmVudE5hbWVzSWZOZWVkZWQiLCJyZW5kZXJXaXRoU3RyaW5nVmFsaWRhdGlvbiIsIndyYXAiLCJlbGVtZW50IiwiY3JlYXRlRWxlbWVudCIsInJlbmRlcmVyIiwicmVuZGVyV2l0aEFjdCIsImJ1aWxkUmVuZGVyUmVzdWx0IiwiX3JlZjIiLCJoYW5kbGVSZW5kZXIiLCJfIiwicGhhc2UiLCJ2YWxpZGF0ZVN0cmluZ3NSZW5kZXJlZFdpdGhpblRleHQiLCJzY3JlZW4iLCJ0b0pTT04iLCJQcm9maWxlciIsImlkIiwib25SZW5kZXIiLCJ1cGRhdGUiLCJ1cGRhdGVXaXRoQWN0IiwiaW5zdGFuY2UiLCJyb290IiwidW5tb3VudCIsImFkZFRvQ2xlYW51cFF1ZXVlIiwicmVzdWx0IiwiYXNzaWduIiwiZ2V0UXVlcmllc0ZvckVsZW1lbnQiLCJyZXJlbmRlciIsImRlYnVnIiwiZ2V0SG9zdENoaWxkcmVuIiwiVU5TQUZFX3Jvb3QiLCJlbnVtZXJhYmxlIiwiRXJyb3IiLCJzZXRSZW5kZXJSZXN1bHQiLCJkZWJ1Z0ltcGwiLCJfcmVmMyIsImdldENvbmZpZyIsImRlZmF1bHREZWJ1Z09wdGlvbnMiLCJkZWJ1Z09wdGlvbnMiLCJtZXNzYWdlIiwiY29uc29sZSIsIndhcm4iLCJqc29uIiwic2hhbGxvdyJdLCJzb3VyY2VzIjpbIi4uL3NyYy9yZW5kZXIudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgUmVhY3RUZXN0SW5zdGFuY2UsIFJlYWN0VGVzdFJlbmRlcmVyIH0gZnJvbSAncmVhY3QtdGVzdC1yZW5kZXJlcic7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBQcm9maWxlciB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBhY3QgZnJvbSAnLi9hY3QnO1xuaW1wb3J0IHsgYWRkVG9DbGVhbnVwUXVldWUgfSBmcm9tICcuL2NsZWFudXAnO1xuaW1wb3J0IHsgZ2V0Q29uZmlnIH0gZnJvbSAnLi9jb25maWcnO1xuaW1wb3J0IHsgZ2V0SG9zdENoaWxkcmVuIH0gZnJvbSAnLi9oZWxwZXJzL2NvbXBvbmVudC10cmVlJztcbmltcG9ydCBkZWJ1Z0RlZXAsIHsgRGVidWdPcHRpb25zIH0gZnJvbSAnLi9oZWxwZXJzL2RlYnVnLWRlZXAnO1xuaW1wb3J0IGRlYnVnU2hhbGxvdyBmcm9tICcuL2hlbHBlcnMvZGVidWctc2hhbGxvdyc7XG5pbXBvcnQgeyBjb25maWd1cmVIb3N0Q29tcG9uZW50TmFtZXNJZk5lZWRlZCB9IGZyb20gJy4vaGVscGVycy9ob3N0LWNvbXBvbmVudC1uYW1lcyc7XG5pbXBvcnQgeyB2YWxpZGF0ZVN0cmluZ3NSZW5kZXJlZFdpdGhpblRleHQgfSBmcm9tICcuL2hlbHBlcnMvc3RyaW5nLXZhbGlkYXRpb24nO1xuaW1wb3J0IHsgcmVuZGVyV2l0aEFjdCB9IGZyb20gJy4vcmVuZGVyLWFjdCc7XG5pbXBvcnQgeyBzZXRSZW5kZXJSZXN1bHQsIHNjcmVlbiB9IGZyb20gJy4vc2NyZWVuJztcbmltcG9ydCB7IGdldFF1ZXJpZXNGb3JFbGVtZW50IH0gZnJvbSAnLi93aXRoaW4nO1xuXG5leHBvcnQgaW50ZXJmYWNlIFJlbmRlck9wdGlvbnMge1xuICB3cmFwcGVyPzogUmVhY3QuQ29tcG9uZW50VHlwZTxhbnk+O1xuICBjcmVhdGVOb2RlTW9jaz86IChlbGVtZW50OiBSZWFjdC5SZWFjdEVsZW1lbnQpID0+IGFueTtcbiAgdW5zdGFibGVfdmFsaWRhdGVTdHJpbmdzUmVuZGVyZWRXaXRoaW5UZXh0PzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IHR5cGUgUmVuZGVyUmVzdWx0ID0gUmV0dXJuVHlwZTx0eXBlb2YgcmVuZGVyPjtcblxuLyoqXG4gKiBSZW5kZXJzIHRlc3QgY29tcG9uZW50IGRlZXBseSB1c2luZyBSZWFjdCBUZXN0IFJlbmRlcmVyIGFuZCBleHBvc2VzIGhlbHBlcnNcbiAqIHRvIGFzc2VydCBvbiB0aGUgb3V0cHV0LlxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiByZW5kZXI8VD4oY29tcG9uZW50OiBSZWFjdC5SZWFjdEVsZW1lbnQ8VD4sIG9wdGlvbnM6IFJlbmRlck9wdGlvbnMgPSB7fSkge1xuICByZXR1cm4gcmVuZGVySW50ZXJuYWwoY29tcG9uZW50LCBvcHRpb25zKTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZW5kZXJJbnRlcm5hbE9wdGlvbnMgZXh0ZW5kcyBSZW5kZXJPcHRpb25zIHtcbiAgZGV0ZWN0SG9zdENvbXBvbmVudE5hbWVzPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlckludGVybmFsPFQ+KFxuICBjb21wb25lbnQ6IFJlYWN0LlJlYWN0RWxlbWVudDxUPixcbiAge1xuICAgIHdyYXBwZXI6IFdyYXBwZXIsXG4gICAgY3JlYXRlTm9kZU1vY2ssXG4gICAgdW5zdGFibGVfdmFsaWRhdGVTdHJpbmdzUmVuZGVyZWRXaXRoaW5UZXh0LFxuICAgIGRldGVjdEhvc3RDb21wb25lbnROYW1lcyA9IHRydWUsXG4gIH06IFJlbmRlckludGVybmFsT3B0aW9ucyA9IHt9LFxuKSB7XG4gIGlmIChkZXRlY3RIb3N0Q29tcG9uZW50TmFtZXMpIHtcbiAgICBjb25maWd1cmVIb3N0Q29tcG9uZW50TmFtZXNJZk5lZWRlZCgpO1xuICB9XG5cbiAgaWYgKHVuc3RhYmxlX3ZhbGlkYXRlU3RyaW5nc1JlbmRlcmVkV2l0aGluVGV4dCkge1xuICAgIHJldHVybiByZW5kZXJXaXRoU3RyaW5nVmFsaWRhdGlvbihjb21wb25lbnQsIHtcbiAgICAgIHdyYXBwZXI6IFdyYXBwZXIsXG4gICAgICBjcmVhdGVOb2RlTW9jayxcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IHdyYXAgPSAoZWxlbWVudDogUmVhY3QuUmVhY3RFbGVtZW50KSA9PiAoV3JhcHBlciA/IDxXcmFwcGVyPntlbGVtZW50fTwvV3JhcHBlcj4gOiBlbGVtZW50KTtcblxuICBjb25zdCByZW5kZXJlciA9IHJlbmRlcldpdGhBY3Qod3JhcChjb21wb25lbnQpLCBjcmVhdGVOb2RlTW9jayA/IHsgY3JlYXRlTm9kZU1vY2sgfSA6IHVuZGVmaW5lZCk7XG5cbiAgcmV0dXJuIGJ1aWxkUmVuZGVyUmVzdWx0KHJlbmRlcmVyLCB3cmFwKTtcbn1cblxuZnVuY3Rpb24gcmVuZGVyV2l0aFN0cmluZ1ZhbGlkYXRpb248VD4oXG4gIGNvbXBvbmVudDogUmVhY3QuUmVhY3RFbGVtZW50PFQ+LFxuICB7XG4gICAgd3JhcHBlcjogV3JhcHBlcixcbiAgICBjcmVhdGVOb2RlTW9jayxcbiAgfTogT21pdDxSZW5kZXJPcHRpb25zLCAndW5zdGFibGVfdmFsaWRhdGVTdHJpbmdzUmVuZGVyZWRXaXRoaW5UZXh0Jz4gPSB7fSxcbikge1xuICBjb25zdCBoYW5kbGVSZW5kZXI6IFJlYWN0LlByb2ZpbGVyUHJvcHNbJ29uUmVuZGVyJ10gPSAoXywgcGhhc2UpID0+IHtcbiAgICBpZiAocGhhc2UgPT09ICd1cGRhdGUnKSB7XG4gICAgICB2YWxpZGF0ZVN0cmluZ3NSZW5kZXJlZFdpdGhpblRleHQoc2NyZWVuLnRvSlNPTigpKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3Qgd3JhcCA9IChlbGVtZW50OiBSZWFjdC5SZWFjdEVsZW1lbnQpID0+IChcbiAgICA8UHJvZmlsZXIgaWQ9XCJyZW5kZXJQcm9maWxlclwiIG9uUmVuZGVyPXtoYW5kbGVSZW5kZXJ9PlxuICAgICAge1dyYXBwZXIgPyA8V3JhcHBlcj57ZWxlbWVudH08L1dyYXBwZXI+IDogZWxlbWVudH1cbiAgICA8L1Byb2ZpbGVyPlxuICApO1xuXG4gIGNvbnN0IHJlbmRlcmVyID0gcmVuZGVyV2l0aEFjdCh3cmFwKGNvbXBvbmVudCksIGNyZWF0ZU5vZGVNb2NrID8geyBjcmVhdGVOb2RlTW9jayB9IDogdW5kZWZpbmVkKTtcbiAgdmFsaWRhdGVTdHJpbmdzUmVuZGVyZWRXaXRoaW5UZXh0KHJlbmRlcmVyLnRvSlNPTigpKTtcblxuICByZXR1cm4gYnVpbGRSZW5kZXJSZXN1bHQocmVuZGVyZXIsIHdyYXApO1xufVxuXG5mdW5jdGlvbiBidWlsZFJlbmRlclJlc3VsdChcbiAgcmVuZGVyZXI6IFJlYWN0VGVzdFJlbmRlcmVyLFxuICB3cmFwOiAoZWxlbWVudDogUmVhY3QuUmVhY3RFbGVtZW50KSA9PiBKU1guRWxlbWVudCxcbikge1xuICBjb25zdCB1cGRhdGUgPSB1cGRhdGVXaXRoQWN0KHJlbmRlcmVyLCB3cmFwKTtcbiAgY29uc3QgaW5zdGFuY2UgPSByZW5kZXJlci5yb290O1xuXG4gIGNvbnN0IHVubW91bnQgPSAoKSA9PiB7XG4gICAgdm9pZCBhY3QoKCkgPT4ge1xuICAgICAgcmVuZGVyZXIudW5tb3VudCgpO1xuICAgIH0pO1xuICB9O1xuXG4gIGFkZFRvQ2xlYW51cFF1ZXVlKHVubW91bnQpO1xuXG4gIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAuLi5nZXRRdWVyaWVzRm9yRWxlbWVudChpbnN0YW5jZSksXG4gICAgdXBkYXRlLFxuICAgIHVubW91bnQsXG4gICAgcmVyZW5kZXI6IHVwZGF0ZSwgLy8gYWxpYXMgZm9yIGB1cGRhdGVgXG4gICAgdG9KU09OOiByZW5kZXJlci50b0pTT04sXG4gICAgZGVidWc6IGRlYnVnKGluc3RhbmNlLCByZW5kZXJlciksXG4gICAgZ2V0IHJvb3QoKTogUmVhY3RUZXN0SW5zdGFuY2Uge1xuICAgICAgcmV0dXJuIGdldEhvc3RDaGlsZHJlbihpbnN0YW5jZSlbMF07XG4gICAgfSxcbiAgICBVTlNBRkVfcm9vdDogaW5zdGFuY2UsXG4gIH07XG5cbiAgLy8gQWRkIGFzIG5vbi1lbnVtZXJhYmxlIHByb3BlcnR5LCBzbyB0aGF0IGl0J3Mgc2FmZSB0byBlbnVtZXJhdGVcbiAgLy8gYHJlbmRlcmAgcmVzdWx0LCBlLmcuIHVzaW5nIGRlc3RydWN0dXJpbmcgcmVzdCBzeW50YXguXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZXN1bHQsICdjb250YWluZXInLCB7XG4gICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgZ2V0KCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBcIidjb250YWluZXInIHByb3BlcnR5IGhhcyBiZWVuIHJlbmFtZWQgdG8gJ1VOU0FGRV9yb290Jy5cXG5cXG5cIiArXG4gICAgICAgICAgXCJDb25zaWRlciB1c2luZyAncm9vdCcgcHJvcGVydHkgd2hpY2ggcmV0dXJucyByb290IGhvc3QgZWxlbWVudC5cIixcbiAgICAgICk7XG4gICAgfSxcbiAgfSk7XG5cbiAgc2V0UmVuZGVyUmVzdWx0KHJlc3VsdCk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVdpdGhBY3QoXG4gIHJlbmRlcmVyOiBSZWFjdFRlc3RSZW5kZXJlcixcbiAgd3JhcDogKGlubmVyRWxlbWVudDogUmVhY3QuUmVhY3RFbGVtZW50KSA9PiBSZWFjdC5SZWFjdEVsZW1lbnQsXG4pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChjb21wb25lbnQ6IFJlYWN0LlJlYWN0RWxlbWVudCkge1xuICAgIHZvaWQgYWN0KCgpID0+IHtcbiAgICAgIHJlbmRlcmVyLnVwZGF0ZSh3cmFwKGNvbXBvbmVudCkpO1xuICAgIH0pO1xuICB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIERlYnVnRnVuY3Rpb24ge1xuICAob3B0aW9ucz86IERlYnVnT3B0aW9ucyB8IHN0cmluZyk6IHZvaWQ7XG4gIHNoYWxsb3c6IChtZXNzYWdlPzogc3RyaW5nKSA9PiB2b2lkO1xufVxuXG5mdW5jdGlvbiBkZWJ1ZyhpbnN0YW5jZTogUmVhY3RUZXN0SW5zdGFuY2UsIHJlbmRlcmVyOiBSZWFjdFRlc3RSZW5kZXJlcik6IERlYnVnRnVuY3Rpb24ge1xuICBmdW5jdGlvbiBkZWJ1Z0ltcGwob3B0aW9ucz86IERlYnVnT3B0aW9ucyB8IHN0cmluZykge1xuICAgIGNvbnN0IHsgZGVmYXVsdERlYnVnT3B0aW9ucyB9ID0gZ2V0Q29uZmlnKCk7XG4gICAgY29uc3QgZGVidWdPcHRpb25zID1cbiAgICAgIHR5cGVvZiBvcHRpb25zID09PSAnc3RyaW5nJ1xuICAgICAgICA/IHsgLi4uZGVmYXVsdERlYnVnT3B0aW9ucywgbWVzc2FnZTogb3B0aW9ucyB9XG4gICAgICAgIDogeyAuLi5kZWZhdWx0RGVidWdPcHRpb25zLCAuLi5vcHRpb25zIH07XG5cbiAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAnVXNpbmcgZGVidWcoXCJtZXNzYWdlXCIpIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBmdXR1cmUgcmVsZWFzZSwgcGxlYXNlIHVzZSBkZWJ1Zyh7IG1lc3NhZ2U7IFwibWVzc2FnZVwiIH0pIGluc3RlYWQuJyxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QganNvbiA9IHJlbmRlcmVyLnRvSlNPTigpO1xuICAgIGlmIChqc29uKSB7XG4gICAgICByZXR1cm4gZGVidWdEZWVwKGpzb24sIGRlYnVnT3B0aW9ucyk7XG4gICAgfVxuICB9XG4gIGRlYnVnSW1wbC5zaGFsbG93ID0gKG1lc3NhZ2U/OiBzdHJpbmcpID0+IGRlYnVnU2hhbGxvdyhpbnN0YW5jZSwgbWVzc2FnZSk7XG4gIHJldHVybiBkZWJ1Z0ltcGw7XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFDQSxJQUFBQSxNQUFBLEdBQUFDLHVCQUFBLENBQUFDLE9BQUE7QUFBK0IsSUFBQUMsS0FBQSxHQUFBSCxNQUFBO0FBRS9CLElBQUFJLElBQUEsR0FBQUMsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFJLFFBQUEsR0FBQUosT0FBQTtBQUNBLElBQUFLLE9BQUEsR0FBQUwsT0FBQTtBQUNBLElBQUFNLGNBQUEsR0FBQU4sT0FBQTtBQUNBLElBQUFPLFVBQUEsR0FBQUosc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFRLGFBQUEsR0FBQUwsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFTLG1CQUFBLEdBQUFULE9BQUE7QUFDQSxJQUFBVSxpQkFBQSxHQUFBVixPQUFBO0FBQ0EsSUFBQVcsVUFBQSxHQUFBWCxPQUFBO0FBQ0EsSUFBQVksT0FBQSxHQUFBWixPQUFBO0FBQ0EsSUFBQWEsT0FBQSxHQUFBYixPQUFBO0FBQWdELFNBQUFHLHVCQUFBVyxHQUFBO0VBQUEsT0FBQUEsR0FBQSxJQUFBQSxHQUFBLENBQUFDLFVBQUEsR0FBQUQsR0FBQTtJQUFBRSxPQUFBLEVBQUFGO0VBQUE7QUFBQTtBQUFBLFNBQUFHLHlCQUFBQyxDQUFBO0VBQUEseUJBQUFDLE9BQUE7RUFBQSxJ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Q2pCMUQsR0FBRyxXQUFBQSxJQUFBLEVBQUc7TUFDSixNQUFNLElBQUkyRCxLQUFLLENBQ2IsNkRBQTZELEdBQzNELGlFQUNKLENBQUM7SUFDSDtFQUNGLENBQUMsQ0FBQztFQUVGLElBQUF0RSxPQUFBLENBQUF1RSxlQUFlLEVBQUNULE1BQU0sQ0FBQztFQUN2QixPQUFPQSxNQUFNO0FBQ2Y7QUFFQSxTQUFTTCxhQUFhQSxDQUNwQmQsUUFBMkIsRUFDM0JILElBQThELEVBQzlEO0VBQ0EsT0FBTyxVQUFVZixTQUE2QixFQUFFO0lBQzlDLEtBQUssSUFBQW5DLElBQUEsQ0FBQWMsT0FBRyxFQUFDLFlBQU07TUFDYnVDLFFBQVEsQ0FBQ2EsTUFBTSxDQUFDaEIsSUFBSSxDQUFDZixTQUFTLENBQUMsQ0FBQztJQUNsQyxDQUFDLENBQUM7RUFDSixDQUFDO0FBQ0g7QUFPQSxTQUFTeUMsS0FBS0EsQ0FBQ1IsUUFBMkIsRUFBRWYsUUFBMkIsRUFBaUI7RUFDdEYsU0FBUzZCLFNBQVNBLENBQUM5QyxPQUErQixFQUFFO0lBQ2xELElBQUErQyxLQUFBLEdBQWdDLElBQUFoRixPQUFBLENBQUFpRixTQUFTLEVBQUMsQ0FBQztNQUFuQ0MsbUJBQUEsR0FBQUYsS0FBQSxDQUFBRSxtQkFBQTtJQUNSLElBQU1DLFlBQVksR0FDaEIsT0FBT2xELE9BQU8sS0FBSyxRQUFRLEdBQUFYLE1BQUEsQ0FBQWdELE1BQUEsS0FDbEJZLG1CQUFtQjtNQUFFRSxPQUFPLEVBQUVuRDtJQUFBLEtBQUFYLE1BQUEsQ0FBQWdELE1BQUEsS0FDOUJZLG1CQUFtQixFQUFLakQsT0FBQSxDQUFTO0lBRTVDLElBQUksT0FBT0EsT0FBTyxLQUFLLFFBQVEsRUFBRTtNQUUvQm9ELE9BQU8sQ0FBQ0MsSUFBSSxDQUNWLCtIQUNGLENBQUM7SUFDSDtJQUVBLElBQU1DLElBQUksR0FBR3JDLFFBQVEsQ0FBQ1MsTUFBTSxDQUFDLENBQUM7SUFDOUIsSUFBSTRCLElBQUksRUFBRTtNQUNSLE9BQU8sSUFBQXJGLFVBQUEsQ0FBQVMsT0FBUyxFQUFDNEUsSUFBSSxFQUFFSixZQUFZLENBQUM7SUFDdEM7RUFDRjtFQUNBSixTQUFTLENBQUNTLE9BQU8sR0FBSSxVQUFBSixPQUFnQjtJQUFBLE9BQUssSUFBQWpGLGFBQUEsQ0FBQVEsT0FBWSxFQUFDc0QsUUFBUSxFQUFFbUIsT0FBTyxDQUFDO0VBQUE7RUFDekUsT0FBT0wsU0FBUztBQUNsQiIsImlnbm9yZUxpc3QiOltdfQ==