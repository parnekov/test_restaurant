{"version":3,"names":["_reactTestRenderer","require","_act","_flushMicroTasks","_reactVersions","wrapAsync","_x","_wrapAsync","apply","arguments","_asyncToGenerator2","default","callback","checkReactVersionAtLeast","previousActEnvironment","getIsReactActEnvironment","setReactActEnvironment","result","flushMicroTasksLegacy","act"],"sources":["../../src/helpers/wrap-async.ts"],"sourcesContent":["/* istanbul ignore file */\n\nimport { act } from 'react-test-renderer';\nimport { getIsReactActEnvironment, setReactActEnvironment } from '../act';\nimport { flushMicroTasksLegacy } from '../flush-micro-tasks';\nimport { checkReactVersionAtLeast } from '../react-versions';\n\n/**\n * Run given async callback with temporarily disabled `act` environment and flushes microtasks queue.\n *\n * @param callback Async callback to run\n * @returns Result of the callback\n */\nexport async function wrapAsync<Result>(callback: () => Promise<Result>): Promise<Result> {\n  if (checkReactVersionAtLeast(18, 0)) {\n    const previousActEnvironment = getIsReactActEnvironment();\n    setReactActEnvironment(false);\n\n    try {\n      const result = await callback();\n      // Flush the microtask queue before restoring the `act` environment\n      await flushMicroTasksLegacy();\n      return result;\n    } finally {\n      setReactActEnvironment(previousActEnvironment);\n    }\n  }\n\n  if (!checkReactVersionAtLeast(16, 9)) {\n    return callback();\n  }\n\n  // Wrapping with act for react version 16.9 to 17.x\n  let result: Result;\n  await act(async () => {\n    result = await callback();\n  });\n\n  // Either we have result or `callback` threw error\n  return result!;\n}\n"],"mappings":";;;;;;;;AAEA,IAAAA,kBAAA,GAAAC,OAAA;AACA,IAAAC,IAAA,GAAAD,OAAA;AACA,IAAAE,gBAAA,GAAAF,OAAA;AACA,IAAAG,cAAA,GAAAH,OAAA;AAAA,SAQsBI,SAASA,CAAAC,EAAA;EAAA,OAAAC,UAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAAA,SAAAF,WAAA;EAAAA,UAAA,OAAAG,kBAAA,CAAAC,OAAA,EAAxB,WAAiCC,QAA+B,EAAmB;IACxF,IAAI,IAAAR,cAAA,CAAAS,wBAAwB,EAAC,EAAE,EAAE,CAAC,CAAC,EAAE;MACnC,IAAMC,sBAAsB,GAAG,IAAAZ,IAAA,CAAAa,wBAAwB,EAAC,CAAC;MACzD,IAAAb,IAAA,CAAAc,sBAAsB,EAAC,KAAK,CAAC;MAE7B,IAAI;QACF,IAAMC,OAAM,SAASL,QAAQ,CAAC,CAAC;QAE/B,MAAM,IAAAT,gBAAA,CAAAe,qBAAqB,EAAC,CAAC;QAC7B,OAAOD,OAAM;MACf,CAAC,SAAS;QACR,IAAAf,IAAA,CAAAc,sBAAsB,EAACF,sBAAsB,CAAC;MAChD;IACF;IAEA,IAAI,CAAC,IAAAV,cAAA,CAAAS,wBAAwB,EAAC,EAAE,EAAE,CAAC,CAAC,EAAE;MACpC,OAAOD,QAAQ,CAAC,CAAC;IACnB;IAGA,IAAIK,MAAc;IAClB,MAAM,IAAAjB,kBAAA,CAAAmB,GAAG,MAAAT,kBAAA,CAAAC,OAAA,EAAC,aAAY;MACpBM,MAAM,SAASL,QAAQ,CAAC,CAAC;IAC3B,CAAC,EAAC;IAGF,OAAOK,MAAM;EACf;EAAA,OAAAV,UAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA","ignoreList":[]}