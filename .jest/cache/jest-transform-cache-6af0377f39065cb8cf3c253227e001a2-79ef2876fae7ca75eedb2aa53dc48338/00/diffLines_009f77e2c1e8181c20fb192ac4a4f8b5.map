{"version":3,"names":["Object","defineProperty","exports","value","printDiffLines","diffLinesUnified2","diffLinesUnified","diffLinesRaw","_diffSequences","_interopRequireDefault","require","_cleanupSemantic","_joinAlignedDiffs","_normalizeDiffOptions","obj","__esModule","default","isEmptyString","lines","length","countChanges","diffs","a","b","forEach","diff","DIFF_DELETE","DIFF_INSERT","printAnnotation","_ref","changeCounts","aAnnotation","aColor","aIndicator","bAnnotation","bColor","bIndicator","includeChangeCounts","omitAnnotationLines","aRest","bRest","aCount","String","bCount","baAnnotationLengthDiff","aAnnotationPadding","repeat","Math","max","bAnnotationPadding","baCountLengthDiff","aCountPadding","bCountPadding","options","expand","joinAlignedDiffsExpand","joinAlignedDiffsNoExpand","aLines","bLines","normalizeDiffOptions","aLinesDisplay","bLinesDisplay","aLinesCompare","bLinesCompare","aIndex","bIndex","aLength","bLength","isCommon","foundSubsequence","nCommon","aCommon","bCommon","push","Diff","DIFF_EQUAL"],"sources":["diffLines.js"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.printDiffLines =\n  exports.diffLinesUnified2 =\n  exports.diffLinesUnified =\n  exports.diffLinesRaw =\n    void 0;\nvar _diffSequences = _interopRequireDefault(require('diff-sequences'));\nvar _cleanupSemantic = require('./cleanupSemantic');\nvar _joinAlignedDiffs = require('./joinAlignedDiffs');\nvar _normalizeDiffOptions = require('./normalizeDiffOptions');\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {default: obj};\n}\n/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nconst isEmptyString = lines => lines.length === 1 && lines[0].length === 0;\nconst countChanges = diffs => {\n  let a = 0;\n  let b = 0;\n  diffs.forEach(diff => {\n    switch (diff[0]) {\n      case _cleanupSemantic.DIFF_DELETE:\n        a += 1;\n        break;\n      case _cleanupSemantic.DIFF_INSERT:\n        b += 1;\n        break;\n    }\n  });\n  return {\n    a,\n    b\n  };\n};\nconst printAnnotation = (\n  {\n    aAnnotation,\n    aColor,\n    aIndicator,\n    bAnnotation,\n    bColor,\n    bIndicator,\n    includeChangeCounts,\n    omitAnnotationLines\n  },\n  changeCounts\n) => {\n  if (omitAnnotationLines) {\n    return '';\n  }\n  let aRest = '';\n  let bRest = '';\n  if (includeChangeCounts) {\n    const aCount = String(changeCounts.a);\n    const bCount = String(changeCounts.b);\n\n    // Padding right aligns the ends of the annotations.\n    const baAnnotationLengthDiff = bAnnotation.length - aAnnotation.length;\n    const aAnnotationPadding = ' '.repeat(Math.max(0, baAnnotationLengthDiff));\n    const bAnnotationPadding = ' '.repeat(Math.max(0, -baAnnotationLengthDiff));\n\n    // Padding left aligns the ends of the counts.\n    const baCountLengthDiff = bCount.length - aCount.length;\n    const aCountPadding = ' '.repeat(Math.max(0, baCountLengthDiff));\n    const bCountPadding = ' '.repeat(Math.max(0, -baCountLengthDiff));\n    aRest = `${aAnnotationPadding}  ${aIndicator} ${aCountPadding}${aCount}`;\n    bRest = `${bAnnotationPadding}  ${bIndicator} ${bCountPadding}${bCount}`;\n  }\n  const a = `${aIndicator} ${aAnnotation}${aRest}`;\n  const b = `${bIndicator} ${bAnnotation}${bRest}`;\n  return `${aColor(a)}\\n${bColor(b)}\\n\\n`;\n};\nconst printDiffLines = (diffs, options) =>\n  printAnnotation(options, countChanges(diffs)) +\n  (options.expand\n    ? (0, _joinAlignedDiffs.joinAlignedDiffsExpand)(diffs, options)\n    : (0, _joinAlignedDiffs.joinAlignedDiffsNoExpand)(diffs, options));\n\n// Compare two arrays of strings line-by-line. Format as comparison lines.\nexports.printDiffLines = printDiffLines;\nconst diffLinesUnified = (aLines, bLines, options) =>\n  printDiffLines(\n    diffLinesRaw(\n      isEmptyString(aLines) ? [] : aLines,\n      isEmptyString(bLines) ? [] : bLines\n    ),\n    (0, _normalizeDiffOptions.normalizeDiffOptions)(options)\n  );\n\n// Given two pairs of arrays of strings:\n// Compare the pair of comparison arrays line-by-line.\n// Format the corresponding lines in the pair of displayable arrays.\nexports.diffLinesUnified = diffLinesUnified;\nconst diffLinesUnified2 = (\n  aLinesDisplay,\n  bLinesDisplay,\n  aLinesCompare,\n  bLinesCompare,\n  options\n) => {\n  if (isEmptyString(aLinesDisplay) && isEmptyString(aLinesCompare)) {\n    aLinesDisplay = [];\n    aLinesCompare = [];\n  }\n  if (isEmptyString(bLinesDisplay) && isEmptyString(bLinesCompare)) {\n    bLinesDisplay = [];\n    bLinesCompare = [];\n  }\n  if (\n    aLinesDisplay.length !== aLinesCompare.length ||\n    bLinesDisplay.length !== bLinesCompare.length\n  ) {\n    // Fall back to diff of display lines.\n    return diffLinesUnified(aLinesDisplay, bLinesDisplay, options);\n  }\n  const diffs = diffLinesRaw(aLinesCompare, bLinesCompare);\n\n  // Replace comparison lines with displayable lines.\n  let aIndex = 0;\n  let bIndex = 0;\n  diffs.forEach(diff => {\n    switch (diff[0]) {\n      case _cleanupSemantic.DIFF_DELETE:\n        diff[1] = aLinesDisplay[aIndex];\n        aIndex += 1;\n        break;\n      case _cleanupSemantic.DIFF_INSERT:\n        diff[1] = bLinesDisplay[bIndex];\n        bIndex += 1;\n        break;\n      default:\n        diff[1] = bLinesDisplay[bIndex];\n        aIndex += 1;\n        bIndex += 1;\n    }\n  });\n  return printDiffLines(\n    diffs,\n    (0, _normalizeDiffOptions.normalizeDiffOptions)(options)\n  );\n};\n\n// Compare two arrays of strings line-by-line.\nexports.diffLinesUnified2 = diffLinesUnified2;\nconst diffLinesRaw = (aLines, bLines) => {\n  const aLength = aLines.length;\n  const bLength = bLines.length;\n  const isCommon = (aIndex, bIndex) => aLines[aIndex] === bLines[bIndex];\n  const diffs = [];\n  let aIndex = 0;\n  let bIndex = 0;\n  const foundSubsequence = (nCommon, aCommon, bCommon) => {\n    for (; aIndex !== aCommon; aIndex += 1) {\n      diffs.push(\n        new _cleanupSemantic.Diff(_cleanupSemantic.DIFF_DELETE, aLines[aIndex])\n      );\n    }\n    for (; bIndex !== bCommon; bIndex += 1) {\n      diffs.push(\n        new _cleanupSemantic.Diff(_cleanupSemantic.DIFF_INSERT, bLines[bIndex])\n      );\n    }\n    for (; nCommon !== 0; nCommon -= 1, aIndex += 1, bIndex += 1) {\n      diffs.push(\n        new _cleanupSemantic.Diff(_cleanupSemantic.DIFF_EQUAL, bLines[bIndex])\n      );\n    }\n  };\n  (0, _diffSequences.default)(aLength, bLength, isCommon, foundSubsequence);\n\n  // After the last common subsequence, push remaining change items.\n  for (; aIndex !== aLength; aIndex += 1) {\n    diffs.push(\n      new _cleanupSemantic.Diff(_cleanupSemantic.DIFF_DELETE, aLines[aIndex])\n    );\n  }\n  for (; bIndex !== bLength; bIndex += 1) {\n    diffs.push(\n      new _cleanupSemantic.Diff(_cleanupSemantic.DIFF_INSERT, bLines[bIndex])\n    );\n  }\n  return diffs;\n};\nexports.diffLinesRaw = diffLinesRaw;\n"],"mappings":"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","ignoreList":[]}