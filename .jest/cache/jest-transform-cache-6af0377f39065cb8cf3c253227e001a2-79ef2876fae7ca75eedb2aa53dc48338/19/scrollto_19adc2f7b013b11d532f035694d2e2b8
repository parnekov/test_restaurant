4549adccd351ff857ec018b8fee4ac44
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.scrollTo = scrollTo;
var _jestMatcherUtils = require("jest-matcher-utils");
var _eventBuilder = require("../event-builder");
var _errors = require("../../helpers/errors");
var _hostComponentNames = require("../../helpers/host-component-names");
var _object = require("../../helpers/object");
var _utils = require("../utils");
var _utils2 = require("./utils");
var _state = require("./state");
function scrollTo(_x, _x2) {
  return _scrollTo.apply(this, arguments);
}
function _scrollTo() {
  _scrollTo = (0, _asyncToGenerator2.default)(function* (element, options) {
    var _options$contentSize$, _options$contentSize, _options$contentSize$2, _options$contentSize2, _dragSteps$at, _ref, _momentumSteps$at;
    if (!(0, _hostComponentNames.isHostScrollView)(element)) {
      throw new _errors.ErrorWithStack(`scrollTo() works only with host "ScrollView" elements. Passed element has type "${element.type}".`, scrollTo);
    }
    ensureScrollViewDirection(element, options);
    (0, _utils.dispatchEvent)(element, 'contentSizeChange', (_options$contentSize$ = (_options$contentSize = options.contentSize) == null ? void 0 : _options$contentSize.width) != null ? _options$contentSize$ : 0, (_options$contentSize$2 = (_options$contentSize2 = options.contentSize) == null ? void 0 : _options$contentSize2.height) != null ? _options$contentSize$2 : 0);
    var initialPosition = (0, _state.getElementScrollOffset)(element);
    var dragSteps = (0, _utils2.createScrollSteps)({
      y: options.y,
      x: options.x
    }, initialPosition, _utils2.linearInterpolator);
    yield emitDragScrollEvents(this.config, element, dragSteps, options);
    var momentumStart = (_dragSteps$at = dragSteps.at(-1)) != null ? _dragSteps$at : initialPosition;
    var momentumSteps = (0, _utils2.createScrollSteps)({
      y: options.momentumY,
      x: options.momentumX
    }, momentumStart, _utils2.inertialInterpolator);
    yield emitMomentumScrollEvents(this.config, element, momentumSteps, options);
    var finalPosition = (_ref = (_momentumSteps$at = momentumSteps.at(-1)) != null ? _momentumSteps$at : dragSteps.at(-1)) != null ? _ref : initialPosition;
    (0, _state.setElementScrollOffset)(element, finalPosition);
  });
  return _scrollTo.apply(this, arguments);
}
function emitDragScrollEvents(_x3, _x4, _x5, _x6) {
  return _emitDragScrollEvents.apply(this, arguments);
}
function _emitDragScrollEvents() {
  _emitDragScrollEvents = (0, _asyncToGenerator2.default)(function* (config, element, scrollSteps, scrollOptions) {
    if (scrollSteps.length === 0) {
      return;
    }
    yield (0, _utils.wait)(config);
    (0, _utils.dispatchEvent)(element, 'scrollBeginDrag', _eventBuilder.EventBuilder.ScrollView.scroll(scrollSteps[0], scrollOptions));
    for (var i = 1; i < scrollSteps.length - 1; i += 1) {
      yield (0, _utils.wait)(config);
      (0, _utils.dispatchEvent)(element, 'scroll', _eventBuilder.EventBuilder.ScrollView.scroll(scrollSteps[i], scrollOptions));
    }
    yield (0, _utils.wait)(config);
    var lastStep = scrollSteps.at(-1);
    (0, _utils.dispatchEvent)(element, 'scrollEndDrag', _eventBuilder.EventBuilder.ScrollView.scroll(lastStep, scrollOptions));
  });
  return _emitDragScrollEvents.apply(this, arguments);
}
function emitMomentumScrollEvents(_x7, _x8, _x9, _x10) {
  return _emitMomentumScrollEvents.apply(this, arguments);
}
function _emitMomentumScrollEvents() {
  _emitMomentumScrollEvents = (0, _asyncToGenerator2.default)(function* (config, element, scrollSteps, scrollOptions) {
    if (scrollSteps.length === 0) {
      return;
    }
    yield (0, _utils.wait)(config);
    (0, _utils.dispatchEvent)(element, 'momentumScrollBegin', _eventBuilder.EventBuilder.ScrollView.scroll(scrollSteps[0], scrollOptions));
    for (var i = 1; i < scrollSteps.length; i += 1) {
      yield (0, _utils.wait)(config);
      (0, _utils.dispatchEvent)(element, 'scroll', _eventBuilder.EventBuilder.ScrollView.scroll(scrollSteps[i], scrollOptions));
    }
    yield (0, _utils.wait)(config);
    var lastStep = scrollSteps.at(-1);
    (0, _utils.dispatchEvent)(element, 'momentumScrollEnd', _eventBuilder.EventBuilder.ScrollView.scroll(lastStep, scrollOptions));
  });
  return _emitMomentumScrollEvents.apply(this, arguments);
}
function ensureScrollViewDirection(element, options) {
  var isVerticalScrollView = element.props.horizontal !== true;
  var hasHorizontalScrollOptions = options.x !== undefined || options.momentumX !== undefined;
  if (isVerticalScrollView && hasHorizontalScrollOptions) {
    throw new _errors.ErrorWithStack(`scrollTo() expected only vertical scroll options: "y" and "momentumY" for vertical "ScrollView" element but received ${(0, _jestMatcherUtils.stringify)((0, _object.pick)(options, ['x', 'momentumX']))}`, scrollTo);
  }
  var hasVerticalScrollOptions = options.y !== undefined || options.momentumY !== undefined;
  if (!isVerticalScrollView && hasVerticalScrollOptions) {
    throw new _errors.ErrorWithStack(`scrollTo() expected only horizontal scroll options: "x" and "momentumX" for horizontal "ScrollView" element but received ${(0, _jestMatcherUtils.stringify)((0, _object.pick)(options, ['y', 'momentumY']))}`, scrollTo);
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfamVzdE1hdGNoZXJVdGlscyIsInJlcXVpcmUiLCJfZXZlbnRCdWlsZGVyIiwiX2Vycm9ycyIsIl9ob3N0Q29tcG9uZW50TmFtZXMiLCJfb2JqZWN0IiwiX3V0aWxzIiwiX3V0aWxzMiIsIl9zdGF0ZSIsInNjcm9sbFRvIiwiX3giLCJfeDIiLCJfc2Nyb2xsVG8iLCJhcHBseSIsImFyZ3VtZW50cyIsIl9hc3luY1RvR2VuZXJhdG9yMiIsImRlZmF1bHQiLCJlbGVtZW50Iiwib3B0aW9ucyIsIl9vcHRpb25zJGNvbnRlbnRTaXplJCIsIl9vcHRpb25zJGNvbnRlbnRTaXplIiwiX29wdGlvbnMkY29udGVudFNpemUkMiIsIl9vcHRpb25zJGNvbnRlbnRTaXplMiIsIl9kcmFnU3RlcHMkYXQiLCJfcmVmIiwiX21vbWVudHVtU3RlcHMkYXQiLCJpc0hvc3RTY3JvbGxWaWV3IiwiRXJyb3JXaXRoU3RhY2siLCJ0eXBlIiwiZW5zdXJlU2Nyb2xsVmlld0RpcmVjdGlvbiIsImRpc3BhdGNoRXZlbnQiLCJjb250ZW50U2l6ZSIsIndpZHRoIiwiaGVpZ2h0IiwiaW5pdGlhbFBvc2l0aW9uIiwiZ2V0RWxlbWVudFNjcm9sbE9mZnNldCIsImRyYWdTdGVwcyIsImNyZWF0ZVNjcm9sbFN0ZXBzIiwieSIsIngiLCJsaW5lYXJJbnRlcnBvbGF0b3IiLCJlbWl0RHJhZ1Njcm9sbEV2ZW50cyIsImNvbmZpZyIsIm1vbWVudHVtU3RhcnQiLCJhdCIsIm1vbWVudHVtU3RlcHMiLCJtb21lbnR1bVkiLCJtb21lbnR1bVgiLCJpbmVydGlhbEludGVycG9sYXRvciIsImVtaXRNb21lbnR1bVNjcm9sbEV2ZW50cyIsImZpbmFsUG9zaXRpb24iLCJzZXRFbGVtZW50U2Nyb2xsT2Zmc2V0IiwiX3gzIiwiX3g0IiwiX3g1IiwiX3g2IiwiX2VtaXREcmFnU2Nyb2xsRXZlbnRzIiwic2Nyb2xsU3RlcHMiLCJzY3JvbGxPcHRpb25zIiwibGVuZ3RoIiwid2FpdCIsIkV2ZW50QnVpbGRlciIsIlNjcm9sbFZpZXciLCJzY3JvbGwiLCJpIiwibGFzdFN0ZXAiLCJfeDciLCJfeDgiLCJfeDkiLCJfeDEwIiwiX2VtaXRNb21lbnR1bVNjcm9sbEV2ZW50cyIsImlzVmVydGljYWxTY3JvbGxWaWV3IiwicHJvcHMiLCJob3Jpem9udGFsIiwiaGFzSG9yaXpvbnRhbFNjcm9sbE9wdGlvbnMiLCJ1bmRlZmluZWQiLCJzdHJpbmdpZnkiLCJwaWNrIiwiaGFzVmVydGljYWxTY3JvbGxPcHRpb25zIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3VzZXItZXZlbnQvc2Nyb2xsL3Njcm9sbC10by50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZWFjdFRlc3RJbnN0YW5jZSB9IGZyb20gJ3JlYWN0LXRlc3QtcmVuZGVyZXInO1xuaW1wb3J0IHsgc3RyaW5naWZ5IH0gZnJvbSAnamVzdC1tYXRjaGVyLXV0aWxzJztcbmltcG9ydCB7IFVzZXJFdmVudENvbmZpZywgVXNlckV2ZW50SW5zdGFuY2UgfSBmcm9tICcuLi9zZXR1cCc7XG5pbXBvcnQgeyBFdmVudEJ1aWxkZXIgfSBmcm9tICcuLi9ldmVudC1idWlsZGVyJztcbmltcG9ydCB7IEVycm9yV2l0aFN0YWNrIH0gZnJvbSAnLi4vLi4vaGVscGVycy9lcnJvcnMnO1xuaW1wb3J0IHsgaXNIb3N0U2Nyb2xsVmlldyB9IGZyb20gJy4uLy4uL2hlbHBlcnMvaG9zdC1jb21wb25lbnQtbmFtZXMnO1xuaW1wb3J0IHsgcGljayB9IGZyb20gJy4uLy4uL2hlbHBlcnMvb2JqZWN0JztcbmltcG9ydCB7IENvbnRlbnRPZmZzZXQgfSBmcm9tICcuLi9ldmVudC1idWlsZGVyL3Njcm9sbC12aWV3JztcbmltcG9ydCB7IGRpc3BhdGNoRXZlbnQsIHdhaXQgfSBmcm9tICcuLi91dGlscyc7XG5pbXBvcnQgeyBjcmVhdGVTY3JvbGxTdGVwcywgaW5lcnRpYWxJbnRlcnBvbGF0b3IsIGxpbmVhckludGVycG9sYXRvciB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHsgZ2V0RWxlbWVudFNjcm9sbE9mZnNldCwgc2V0RWxlbWVudFNjcm9sbE9mZnNldCB9IGZyb20gJy4vc3RhdGUnO1xuXG5pbnRlcmZhY2UgQ29tbW9uU2Nyb2xsVG9PcHRpb25zIHtcbiAgY29udGVudFNpemU/OiB7XG4gICAgaGVpZ2h0OiBudW1iZXI7XG4gICAgd2lkdGg6IG51bWJlcjtcbiAgfTtcbiAgbGF5b3V0TWVhc3VyZW1lbnQ/OiB7XG4gICAgaGVpZ2h0OiBudW1iZXI7XG4gICAgd2lkdGg6IG51bWJlcjtcbiAgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWZXJ0aWNhbFNjcm9sbFRvT3B0aW9ucyBleHRlbmRzIENvbW1vblNjcm9sbFRvT3B0aW9ucyB7XG4gIHk6IG51bWJlcjtcbiAgbW9tZW50dW1ZPzogbnVtYmVyO1xuXG4gIC8vIFZlcnRpY2FsIHNjcm9sbCBzaG91bGQgbm90IGNvbnRhaW4gaG9yaXpvbnRhbCBzY3JvbGwgcGFydC5cbiAgeD86IG5ldmVyO1xuICBtb21lbnR1bVg/OiBuZXZlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBIb3Jpem9udGFsU2Nyb2xsVG9PcHRpb25zIGV4dGVuZHMgQ29tbW9uU2Nyb2xsVG9PcHRpb25zIHtcbiAgeDogbnVtYmVyO1xuICBtb21lbnR1bVg/OiBudW1iZXI7XG5cbiAgLy8gSG9yaXpvbnRhbCBzY3JvbGwgc2hvdWxkIG5vdCBjb250YWluIHZlcnRpY2FsIHNjcm9sbCBwYXJ0LlxuICB5PzogbmV2ZXI7XG4gIG1vbWVudHVtWT86IG5ldmVyO1xufVxuXG5leHBvcnQgdHlwZSBTY3JvbGxUb09wdGlvbnMgPSBWZXJ0aWNhbFNjcm9sbFRvT3B0aW9ucyB8IEhvcml6b250YWxTY3JvbGxUb09wdGlvbnM7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzY3JvbGxUbyhcbiAgdGhpczogVXNlckV2ZW50SW5zdGFuY2UsXG4gIGVsZW1lbnQ6IFJlYWN0VGVzdEluc3RhbmNlLFxuICBvcHRpb25zOiBTY3JvbGxUb09wdGlvbnMsXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgaWYgKCFpc0hvc3RTY3JvbGxWaWV3KGVsZW1lbnQpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yV2l0aFN0YWNrKFxuICAgICAgYHNjcm9sbFRvKCkgd29ya3Mgb25seSB3aXRoIGhvc3QgXCJTY3JvbGxWaWV3XCIgZWxlbWVudHMuIFBhc3NlZCBlbGVtZW50IGhhcyB0eXBlIFwiJHtlbGVtZW50LnR5cGV9XCIuYCxcbiAgICAgIHNjcm9sbFRvLFxuICAgICk7XG4gIH1cblxuICBlbnN1cmVTY3JvbGxWaWV3RGlyZWN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpO1xuXG4gIGRpc3BhdGNoRXZlbnQoXG4gICAgZWxlbWVudCxcbiAgICAnY29udGVudFNpemVDaGFuZ2UnLFxuICAgIG9wdGlvbnMuY29udGVudFNpemU/LndpZHRoID8/IDAsXG4gICAgb3B0aW9ucy5jb250ZW50U2l6ZT8uaGVpZ2h0ID8/IDAsXG4gICk7XG5cbiAgY29uc3QgaW5pdGlhbFBvc2l0aW9uID0gZ2V0RWxlbWVudFNjcm9sbE9mZnNldChlbGVtZW50KTtcbiAgY29uc3QgZHJhZ1N0ZXBzID0gY3JlYXRlU2Nyb2xsU3RlcHMoXG4gICAgeyB5OiBvcHRpb25zLnksIHg6IG9wdGlvbnMueCB9LFxuICAgIGluaXRpYWxQb3NpdGlvbixcbiAgICBsaW5lYXJJbnRlcnBvbGF0b3IsXG4gICk7XG4gIGF3YWl0IGVtaXREcmFnU2Nyb2xsRXZlbnRzKHRoaXMuY29uZmlnLCBlbGVtZW50LCBkcmFnU3RlcHMsIG9wdGlvbnMpO1xuXG4gIGNvbnN0IG1vbWVudHVtU3RhcnQgPSBkcmFnU3RlcHMuYXQoLTEpID8/IGluaXRpYWxQb3NpdGlvbjtcbiAgY29uc3QgbW9tZW50dW1TdGVwcyA9IGNyZWF0ZVNjcm9sbFN0ZXBzKFxuICAgIHsgeTogb3B0aW9ucy5tb21lbnR1bVksIHg6IG9wdGlvbnMubW9tZW50dW1YIH0sXG4gICAgbW9tZW50dW1TdGFydCxcbiAgICBpbmVydGlhbEludGVycG9sYXRvcixcbiAgKTtcbiAgYXdhaXQgZW1pdE1vbWVudHVtU2Nyb2xsRXZlbnRzKHRoaXMuY29uZmlnLCBlbGVtZW50LCBtb21lbnR1bVN0ZXBzLCBvcHRpb25zKTtcblxuICBjb25zdCBmaW5hbFBvc2l0aW9uID0gbW9tZW50dW1TdGVwcy5hdCgtMSkgPz8gZHJhZ1N0ZXBzLmF0KC0xKSA/PyBpbml0aWFsUG9zaXRpb247XG4gIHNldEVsZW1lbnRTY3JvbGxPZmZzZXQoZWxlbWVudCwgZmluYWxQb3NpdGlvbik7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGVtaXREcmFnU2Nyb2xsRXZlbnRzKFxuICBjb25maWc6IFVzZXJFdmVudENvbmZpZyxcbiAgZWxlbWVudDogUmVhY3RUZXN0SW5zdGFuY2UsXG4gIHNjcm9sbFN0ZXBzOiBDb250ZW50T2Zmc2V0W10sXG4gIHNjcm9sbE9wdGlvbnM6IFNjcm9sbFRvT3B0aW9ucyxcbikge1xuICBpZiAoc2Nyb2xsU3RlcHMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgYXdhaXQgd2FpdChjb25maWcpO1xuICBkaXNwYXRjaEV2ZW50KFxuICAgIGVsZW1lbnQsXG4gICAgJ3Njcm9sbEJlZ2luRHJhZycsXG4gICAgRXZlbnRCdWlsZGVyLlNjcm9sbFZpZXcuc2Nyb2xsKHNjcm9sbFN0ZXBzWzBdLCBzY3JvbGxPcHRpb25zKSxcbiAgKTtcblxuICAvLyBOb3RlOiBleHBlcmltZW50YWxseSwgaW4gY2FzZSBvZiBkcmFnIHNjcm9sbCB0aGUgbGFzdCBzY3JvbGwgc3RlcFxuICAvLyB3aWxsIG5vdCB0cmlnZ2VyIGBzY3JvbGxgIGV2ZW50LlxuICAvLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9jYWxsc3RhY2svcmVhY3QtbmF0aXZlLXRlc3RpbmctbGlicmFyeS93aWtpL1Njcm9sbFZpZXctRXZlbnRzXG4gIGZvciAobGV0IGkgPSAxOyBpIDwgc2Nyb2xsU3RlcHMubGVuZ3RoIC0gMTsgaSArPSAxKSB7XG4gICAgYXdhaXQgd2FpdChjb25maWcpO1xuICAgIGRpc3BhdGNoRXZlbnQoZWxlbWVudCwgJ3Njcm9sbCcsIEV2ZW50QnVpbGRlci5TY3JvbGxWaWV3LnNjcm9sbChzY3JvbGxTdGVwc1tpXSwgc2Nyb2xsT3B0aW9ucykpO1xuICB9XG5cbiAgYXdhaXQgd2FpdChjb25maWcpO1xuICBjb25zdCBsYXN0U3RlcCA9IHNjcm9sbFN0ZXBzLmF0KC0xKTtcbiAgZGlzcGF0Y2hFdmVudChlbGVtZW50LCAnc2Nyb2xsRW5kRHJhZycsIEV2ZW50QnVpbGRlci5TY3JvbGxWaWV3LnNjcm9sbChsYXN0U3RlcCwgc2Nyb2xsT3B0aW9ucykpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBlbWl0TW9tZW50dW1TY3JvbGxFdmVudHMoXG4gIGNvbmZpZzogVXNlckV2ZW50Q29uZmlnLFxuICBlbGVtZW50OiBSZWFjdFRlc3RJbnN0YW5jZSxcbiAgc2Nyb2xsU3RlcHM6IENvbnRlbnRPZmZzZXRbXSxcbiAgc2Nyb2xsT3B0aW9uczogU2Nyb2xsVG9PcHRpb25zLFxuKSB7XG4gIGlmIChzY3JvbGxTdGVwcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBhd2FpdCB3YWl0KGNvbmZpZyk7XG4gIGRpc3BhdGNoRXZlbnQoXG4gICAgZWxlbWVudCxcbiAgICAnbW9tZW50dW1TY3JvbGxCZWdpbicsXG4gICAgRXZlbnRCdWlsZGVyLlNjcm9sbFZpZXcuc2Nyb2xsKHNjcm9sbFN0ZXBzWzBdLCBzY3JvbGxPcHRpb25zKSxcbiAgKTtcblxuICAvLyBOb3RlOiBleHBlcmltZW50YWxseSwgaW4gY2FzZSBvZiBtb21lbnR1bSBzY3JvbGwgdGhlIGxhc3Qgc2Nyb2xsIHN0ZXBcbiAgLy8gd2lsbCB0cmlnZ2VyIGBzY3JvbGxgIGV2ZW50LlxuICAvLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9jYWxsc3RhY2svcmVhY3QtbmF0aXZlLXRlc3RpbmctbGlicmFyeS93aWtpL1Njcm9sbFZpZXctRXZlbnRzXG4gIGZvciAobGV0IGkgPSAxOyBpIDwgc2Nyb2xsU3RlcHMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBhd2FpdCB3YWl0KGNvbmZpZyk7XG4gICAgZGlzcGF0Y2hFdmVudChlbGVtZW50LCAnc2Nyb2xsJywgRXZlbnRCdWlsZGVyLlNjcm9sbFZpZXcuc2Nyb2xsKHNjcm9sbFN0ZXBzW2ldLCBzY3JvbGxPcHRpb25zKSk7XG4gIH1cblxuICBhd2FpdCB3YWl0KGNvbmZpZyk7XG4gIGNvbnN0IGxhc3RTdGVwID0gc2Nyb2xsU3RlcHMuYXQoLTEpO1xuICBkaXNwYXRjaEV2ZW50KFxuICAgIGVsZW1lbnQsXG4gICAgJ21vbWVudHVtU2Nyb2xsRW5kJyxcbiAgICBFdmVudEJ1aWxkZXIuU2Nyb2xsVmlldy5zY3JvbGwobGFzdFN0ZXAsIHNjcm9sbE9wdGlvbnMpLFxuICApO1xufVxuXG5mdW5jdGlvbiBlbnN1cmVTY3JvbGxWaWV3RGlyZWN0aW9uKGVsZW1lbnQ6IFJlYWN0VGVzdEluc3RhbmNlLCBvcHRpb25zOiBTY3JvbGxUb09wdGlvbnMpIHtcbiAgY29uc3QgaXNWZXJ0aWNhbFNjcm9sbFZpZXcgPSBlbGVtZW50LnByb3BzLmhvcml6b250YWwgIT09IHRydWU7XG5cbiAgY29uc3QgaGFzSG9yaXpvbnRhbFNjcm9sbE9wdGlvbnMgPSBvcHRpb25zLnggIT09IHVuZGVmaW5lZCB8fCBvcHRpb25zLm1vbWVudHVtWCAhPT0gdW5kZWZpbmVkO1xuICBpZiAoaXNWZXJ0aWNhbFNjcm9sbFZpZXcgJiYgaGFzSG9yaXpvbnRhbFNjcm9sbE9wdGlvbnMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3JXaXRoU3RhY2soXG4gICAgICBgc2Nyb2xsVG8oKSBleHBlY3RlZCBvbmx5IHZlcnRpY2FsIHNjcm9sbCBvcHRpb25zOiBcInlcIiBhbmQgXCJtb21lbnR1bVlcIiBmb3IgdmVydGljYWwgXCJTY3JvbGxWaWV3XCIgZWxlbWVudCBidXQgcmVjZWl2ZWQgJHtzdHJpbmdpZnkoXG4gICAgICAgIHBpY2sob3B0aW9ucywgWyd4JywgJ21vbWVudHVtWCddKSxcbiAgICAgICl9YCxcbiAgICAgIHNjcm9sbFRvLFxuICAgICk7XG4gIH1cblxuICBjb25zdCBoYXNWZXJ0aWNhbFNjcm9sbE9wdGlvbnMgPSBvcHRpb25zLnkgIT09IHVuZGVmaW5lZCB8fCBvcHRpb25zLm1vbWVudHVtWSAhPT0gdW5kZWZpbmVkO1xuICBpZiAoIWlzVmVydGljYWxTY3JvbGxWaWV3ICYmIGhhc1ZlcnRpY2FsU2Nyb2xsT3B0aW9ucykge1xuICAgIHRocm93IG5ldyBFcnJvcldpdGhTdGFjayhcbiAgICAgIGBzY3JvbGxUbygpIGV4cGVjdGVkIG9ubHkgaG9yaXpvbnRhbCBzY3JvbGwgb3B0aW9uczogXCJ4XCIgYW5kIFwibW9tZW50dW1YXCIgZm9yIGhvcml6b250YWwgXCJTY3JvbGxWaWV3XCIgZWxlbWVudCBidXQgcmVjZWl2ZWQgJHtzdHJpbmdpZnkoXG4gICAgICAgIHBpY2sob3B0aW9ucywgWyd5JywgJ21vbWVudHVtWSddKSxcbiAgICAgICl9YCxcbiAgICAgIHNjcm9sbFRvLFxuICAgICk7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFDQSxJQUFBQSxpQkFBQSxHQUFBQyxPQUFBO0FBRUEsSUFBQUMsYUFBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsT0FBQSxHQUFBRixPQUFBO0FBQ0EsSUFBQUcsbUJBQUEsR0FBQUgsT0FBQTtBQUNBLElBQUFJLE9BQUEsR0FBQUosT0FBQTtBQUVBLElBQUFLLE1BQUEsR0FBQUwsT0FBQTtBQUNBLElBQUFNLE9BQUEsR0FBQU4sT0FBQTtBQUNBLElBQUFPLE1BQUEsR0FBQVAsT0FBQTtBQUFBLFNBaUNzQlEsUUFBUUEsQ0FBQUMsRUFBQSxFQUFBQyxHQUFBO0VBQUEsT0FBQUMsU0FBQSxDQUFBQyxLQUFBLE9BQUFDLFNBQUE7QUFBQTtBQUFBLFNBQUFGLFVBQUE7RUFBQUEsU0FBQSxPQUFBRyxrQkFBQSxDQUFBQyxPQUFBLEVBQXZCLFdBRUxDLE9BQTBCLEVBQzFCQyxPQUF3QixFQUNUO0lBQUEsSUFBQUMscUJBQUEsRUFBQUMsb0JBQUEsRUFBQUMsc0JBQUEsRUFBQUMs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