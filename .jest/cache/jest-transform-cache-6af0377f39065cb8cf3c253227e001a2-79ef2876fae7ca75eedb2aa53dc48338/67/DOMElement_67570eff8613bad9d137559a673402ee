4423e513a766679b51d233fa33fa1c63
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.test = exports.serialize = exports.default = void 0;
var _markup = require('./lib/markup');
var ELEMENT_NODE = 1;
var TEXT_NODE = 3;
var COMMENT_NODE = 8;
var FRAGMENT_NODE = 11;
var ELEMENT_REGEXP = /^((HTML|SVG)\w*)?Element$/;
var testHasAttribute = function testHasAttribute(val) {
  try {
    return typeof val.hasAttribute === 'function' && val.hasAttribute('is');
  } catch (_unused) {
    return false;
  }
};
var testNode = function testNode(val) {
  var constructorName = val.constructor.name;
  var nodeType = val.nodeType,
    tagName = val.tagName;
  var isCustomElement = typeof tagName === 'string' && tagName.includes('-') || testHasAttribute(val);
  return nodeType === ELEMENT_NODE && (ELEMENT_REGEXP.test(constructorName) || isCustomElement) || nodeType === TEXT_NODE && constructorName === 'Text' || nodeType === COMMENT_NODE && constructorName === 'Comment' || nodeType === FRAGMENT_NODE && constructorName === 'DocumentFragment';
};
var test = function test(val) {
  var _val$constructor;
  return (val == null ? void 0 : (_val$constructor = val.constructor) == null ? void 0 : _val$constructor.name) && testNode(val);
};
exports.test = test;
function nodeIsText(node) {
  return node.nodeType === TEXT_NODE;
}
function nodeIsComment(node) {
  return node.nodeType === COMMENT_NODE;
}
function nodeIsFragment(node) {
  return node.nodeType === FRAGMENT_NODE;
}
var serialize = function serialize(node, config, indentation, depth, refs, printer) {
  if (nodeIsText(node)) {
    return (0, _markup.printText)(node.data, config);
  }
  if (nodeIsComment(node)) {
    return (0, _markup.printComment)(node.data, config);
  }
  var type = nodeIsFragment(node) ? 'DocumentFragment' : node.tagName.toLowerCase();
  if (++depth > config.maxDepth) {
    return (0, _markup.printElementAsLeaf)(type, config);
  }
  return (0, _markup.printElement)(type, (0, _markup.printProps)(nodeIsFragment(node) ? [] : Array.from(node.attributes, function (attr) {
    return attr.name;
  }).sort(), nodeIsFragment(node) ? {} : Array.from(node.attributes).reduce(function (props, attribute) {
    props[attribute.name] = attribute.value;
    return props;
  }, {}), config, indentation + config.indent, depth, refs, printer), (0, _markup.printChildren)(Array.prototype.slice.call(node.childNodes || node.children), config, indentation + config.indent, depth, refs, printer), config, indentation);
};
exports.serialize = serialize;
var plugin = {
  serialize: serialize,
  test: test
};
var _default = plugin;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsInRlc3QiLCJzZXJpYWxpemUiLCJkZWZhdWx0IiwiX21hcmt1cCIsInJlcXVpcmUiLCJFTEVNRU5UX05PREUiLCJURVhUX05PREUiLCJDT01NRU5UX05PREUiLCJGUkFHTUVOVF9OT0RFIiwiRUxFTUVOVF9SRUdFWFAiLCJ0ZXN0SGFzQXR0cmlidXRlIiwidmFsIiwiaGFzQXR0cmlidXRlIiwiX3VudXNlZCIsInRlc3ROb2RlIiwiY29uc3RydWN0b3JOYW1lIiwiY29uc3RydWN0b3IiLCJuYW1lIiwibm9kZVR5cGUiLCJ0YWdOYW1lIiwiaXNDdXN0b21FbGVtZW50IiwiaW5jbHVkZXMiLCJfdmFsJGNvbnN0cnVjdG9yIiwibm9kZUlzVGV4dCIsIm5vZGUiLCJub2RlSXNDb21tZW50Iiwibm9kZUlzRnJhZ21lbnQiLCJjb25maWciLCJpbmRlbnRhdGlvbiIsImRlcHRoIiwicmVmcyIsInByaW50ZXIiLCJwcmludFRleHQiLCJkYXRhIiwicHJpbnRDb21tZW50IiwidHlwZSIsInRvTG93ZXJDYXNlIiwibWF4RGVwdGgiLCJwcmludEVsZW1lbnRBc0xlYWYiLCJwcmludEVsZW1lbnQiLCJwcmludFByb3BzIiwiQXJyYXkiLCJmcm9tIiwiYXR0cmlidXRlcyIsImF0dHIiLCJzb3J0IiwicmVkdWNlIiwicHJvcHMiLCJhdHRyaWJ1dGUiLCJpbmRlbnQiLCJwcmludENoaWxkcmVuIiwicHJvdG90eXBlIiwic2xpY2UiLCJjYWxsIiwiY2hpbGROb2RlcyIsImNoaWxkcmVuIiwicGx1Z2luIiwiX2RlZmF1bHQiXSwic291cmNlcyI6WyJET01FbGVtZW50LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLnRlc3QgPSBleHBvcnRzLnNlcmlhbGl6ZSA9IGV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBfbWFya3VwID0gcmVxdWlyZSgnLi9saWIvbWFya3VwJyk7XG4vKipcbiAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuY29uc3QgRUxFTUVOVF9OT0RFID0gMTtcbmNvbnN0IFRFWFRfTk9ERSA9IDM7XG5jb25zdCBDT01NRU5UX05PREUgPSA4O1xuY29uc3QgRlJBR01FTlRfTk9ERSA9IDExO1xuY29uc3QgRUxFTUVOVF9SRUdFWFAgPSAvXigoSFRNTHxTVkcpXFx3Kik/RWxlbWVudCQvO1xuY29uc3QgdGVzdEhhc0F0dHJpYnV0ZSA9IHZhbCA9PiB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWwuaGFzQXR0cmlidXRlID09PSAnZnVuY3Rpb24nICYmIHZhbC5oYXNBdHRyaWJ1dGUoJ2lzJyk7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufTtcbmNvbnN0IHRlc3ROb2RlID0gdmFsID0+IHtcbiAgY29uc3QgY29uc3RydWN0b3JOYW1lID0gdmFsLmNvbnN0cnVjdG9yLm5hbWU7XG4gIGNvbnN0IHtub2RlVHlwZSwgdGFnTmFtZX0gPSB2YWw7XG4gIGNvbnN0IGlzQ3VzdG9tRWxlbWVudCA9XG4gICAgKHR5cGVvZiB0YWdOYW1lID09PSAnc3RyaW5nJyAmJiB0YWdOYW1lLmluY2x1ZGVzKCctJykpIHx8XG4gICAgdGVzdEhhc0F0dHJpYnV0ZSh2YWwpO1xuICByZXR1cm4gKFxuICAgIChub2RlVHlwZSA9PT0gRUxFTUVOVF9OT0RFICYmXG4gICAgICAoRUxFTUVOVF9SRUdFWFAudGVzdChjb25zdHJ1Y3Rvck5hbWUpIHx8IGlzQ3VzdG9tRWxlbWVudCkpIHx8XG4gICAgKG5vZGVUeXBlID09PSBURVhUX05PREUgJiYgY29uc3RydWN0b3JOYW1lID09PSAnVGV4dCcpIHx8XG4gICAgKG5vZGVUeXBlID09PSBDT01NRU5UX05PREUgJiYgY29uc3RydWN0b3JOYW1lID09PSAnQ29tbWVudCcpIHx8XG4gICAgKG5vZGVUeXBlID09PSBGUkFHTUVOVF9OT0RFICYmIGNvbnN0cnVjdG9yTmFtZSA9PT0gJ0RvY3VtZW50RnJhZ21lbnQnKVxuICApO1xufTtcbmNvbnN0IHRlc3QgPSB2YWwgPT4gdmFsPy5jb25zdHJ1Y3Rvcj8ubmFtZSAmJiB0ZXN0Tm9kZSh2YWwpO1xuZXhwb3J0cy50ZXN0ID0gdGVzdDtcbmZ1bmN0aW9uIG5vZGVJc1RleHQobm9kZSkge1xuICByZXR1cm4gbm9kZS5ub2RlVHlwZSA9PT0gVEVYVF9OT0RFO1xufVxuZnVuY3Rpb24gbm9kZUlzQ29tbWVudChub2RlKSB7XG4gIHJldHVybiBub2RlLm5vZGVUeXBlID09PSBDT01NRU5UX05PREU7XG59XG5mdW5jdGlvbiBub2RlSXNGcmFnbWVudChub2RlKSB7XG4gIHJldHVybiBub2RlLm5vZGVUeXBlID09PSBGUkFHTUVOVF9OT0RFO1xufVxuY29uc3Qgc2VyaWFsaXplID0gKG5vZGUsIGNvbmZpZywgaW5kZW50YXRpb24sIGRlcHRoLCByZWZzLCBwcmludGVyKSA9PiB7XG4gIGlmIChub2RlSXNUZXh0KG5vZGUpKSB7XG4gICAgcmV0dXJuICgwLCBfbWFya3VwLnByaW50VGV4dCkobm9kZS5kYXRhLCBjb25maWcpO1xuICB9XG4gIGlmIChub2RlSXNDb21tZW50KG5vZGUpKSB7XG4gICAgcmV0dXJuICgwLCBfbWFya3VwLnByaW50Q29tbWVudCkobm9kZS5kYXRhLCBjb25maWcpO1xuICB9XG4gIGNvbnN0IHR5cGUgPSBub2RlSXNGcmFnbWVudChub2RlKVxuICAgID8gJ0RvY3VtZW50RnJhZ21lbnQnXG4gICAgOiBub2RlLnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbiAgaWYgKCsrZGVwdGggPiBjb25maWcubWF4RGVwdGgpIHtcbiAgICByZXR1cm4gKDAsIF9tYXJrdXAucHJpbnRFbGVtZW50QXNMZWFmKSh0eXBlLCBjb25maWcpO1xuICB9XG4gIHJldHVybiAoMCwgX21hcmt1cC5wcmludEVsZW1lbnQpKFxuICAgIHR5cGUsXG4gICAgKDAsIF9tYXJrdXAucHJpbnRQcm9wcykoXG4gICAgICBub2RlSXNGcmFnbWVudChub2RlKVxuICAgICAgICA/IFtdXG4gICAgICAgIDogQXJyYXkuZnJvbShub2RlLmF0dHJpYnV0ZXMsIGF0dHIgPT4gYXR0ci5uYW1lKS5zb3J0KCksXG4gICAgICBub2RlSXNGcmFnbWVudChub2RlKVxuICAgICAgICA/IHt9XG4gICAgICAgIDogQXJyYXkuZnJvbShub2RlLmF0dHJpYnV0ZXMpLnJlZHVjZSgocHJvcHMsIGF0dHJpYnV0ZSkgPT4ge1xuICAgICAgICAgICAgcHJvcHNbYXR0cmlidXRlLm5hbWVdID0gYXR0cmlidXRlLnZhbHVlO1xuICAgICAgICAgICAgcmV0dXJuIHByb3BzO1xuICAgICAgICAgIH0sIHt9KSxcbiAgICAgIGNvbmZpZyxcbiAgICAgIGluZGVudGF0aW9uICsgY29uZmlnLmluZGVudCxcbiAgICAgIGRlcHRoLFxuICAgICAgcmVmcyxcbiAgICAgIHByaW50ZXJcbiAgICApLFxuICAgICgwLCBfbWFya3VwLnByaW50Q2hpbGRyZW4pKFxuICAgICAgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwobm9kZS5jaGlsZE5vZGVzIHx8IG5vZGUuY2hpbGRyZW4pLFxuICAgICAgY29uZmlnLFxuICAgICAgaW5kZW50YXRpb24gKyBjb25maWcuaW5kZW50LFxuICAgICAgZGVwdGgsXG4gICAgICByZWZzLFxuICAgICAgcHJpbnRlclxuICAgICksXG4gICAgY29uZmlnLFxuICAgIGluZGVudGF0aW9uXG4gICk7XG59O1xuZXhwb3J0cy5zZXJpYWxpemUgPSBzZXJpYWxpemU7XG5jb25zdCBwbHVnaW4gPSB7XG4gIHNlcmlhbGl6ZSxcbiAgdGVzdFxufTtcbnZhciBfZGVmYXVsdCA9IHBsdWdpbjtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZOztBQUVaQSxNQUFNLENBQUNDLGNBQWMsQ0FBQ0MsT0FBTyxFQUFFLFlBQVksRUFBRTtFQUMzQ0MsS0FBSyxFQUFFO0FBQ1QsQ0FBQyxDQUFDO0FBQ0ZELE9BQU8sQ0FBQ0UsSUFBSSxHQUFHRixPQUFPLENBQUNHLFNBQVMsR0FBR0gsT0FBTyxDQUFDSSxPQUFPLEdBQUcsS0FBSyxDQUFDO0FBQzNELElBQUlDLE9BQU8sR0FBR0MsT0FBTyxDQUFDLGNBQWMsQ0FBQztBQVFyQyxJQUFNQyxZQUFZLEdBQUcsQ0FBQztBQUN0QixJQUFNQyxTQUFTLEdBQUcsQ0FBQztBQUNuQixJQUFNQyxZQUFZLEdBQUcsQ0FBQztBQUN0QixJQUFNQyxhQUFhLEdBQUcsRUFBRTtBQUN4QixJQUFNQyxjQUFjLEdBQUcsMkJBQTJCO0FBQ2xELElBQU1DLGdCQUFnQixHQUFHLFNBQW5CQSxnQkFBZ0JBLENBQUdDLEdBQUcsRUFBSTtFQUM5QixJQUFJO0lBQ0YsT0FBTyxPQUFPQSxHQUFHLENBQUNDLFlBQVksS0FBSyxVQUFVLElBQUlELEdBQUcsQ0FBQ0MsWUFBWSxDQUFDLElBQUksQ0FBQztFQUN6RSxDQUFDLENBQUMsT0FBQUMsT0FBQSxFQUFNO0lBQ04sT0FBTyxLQUFLO0VBQ2Q7QUFDRixDQUFDO0FBQ0QsSUFBTUMsUUFBUSxHQUFHLFNBQVhBLFFBQVFBLENBQUdILEdBQUcsRUFBSTtFQUN0QixJQUFNSSxlQUFlLEdBQUdKLEdBQUcsQ0FBQ0ssV0FBVyxDQUFDQyxJQUFJO0VBQzVDLElBQU9DLFFBQVEsR0FBYVAsR0FBRyxDQUF4Qk8sUUFBUTtJQUFFQyxPQUFPLEdBQUlSLEdBQUcsQ0FBZFEsT0FBTztFQUN4QixJQUFNQyxlQUFlLEdBQ2xCLE9BQU9ELE9BQU8sS0FBSyxRQUFRLElBQUlBLE9BQU8sQ0FBQ0UsUUFB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